<!DOCTYPE html>
<html>

<head><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta http-equiv="Accept-CH" content="DPR, Viewport-Width, Width">
<link rel="icon" href=/fav.png type="image/gif">


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
>
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      media="print" onload="this.media='all'" />
<noscript>
  <link
          href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
          rel="stylesheet">
</noscript>


<link rel="stylesheet" href="/css/font.css" media="all">



<meta property="og:title" content="Predicting Energy Futures" />
<meta property="og:description" content="Forecasting Energy Markets Introduction Over the past several years, global events have rocked the energy markets: the Covid-19 pandemic caused the price of oil to crash, while a combination of inflation and the sanctions placed on Russia due to its invasion of Ukraine have caused the price of oil and natural gas to skyrocket. As a result, it is important to be able to forecast energy markets accurately despite global uncertainty." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hugo-profile.netlify.app/blogs/forecasting_energy_markets/" /><meta property="article:section" content="blogs" />
<meta property="article:published_time" content="2023-01-03T23:29:21+05:30" />
<meta property="article:modified_time" content="2023-01-03T23:29:21+05:30" /><meta property="og:site_name" content="Myles Kornfeld" />


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Predicting Energy Futures"/>
<meta name="twitter:description" content="Forecasting Energy Markets Introduction Over the past several years, global events have rocked the energy markets: the Covid-19 pandemic caused the price of oil to crash, while a combination of inflation and the sanctions placed on Russia due to its invasion of Ukraine have caused the price of oil and natural gas to skyrocket. As a result, it is important to be able to forecast energy markets accurately despite global uncertainty."/>


<link rel="stylesheet" href="/bootstrap-5/css/bootstrap.min.css" media="all"><link rel="stylesheet" href="/css/header.css" media="all">
<link rel="stylesheet" href="/css/footer.css" media="all">


<link rel="stylesheet" href="/css/theme.css" media="all">




<style>
    :root {
        --text-color: #343a40;
        --text-secondary-color: #6c757d;
        --background-color: #eaedf0;
        --secondary-background-color: #64ffda1a;
        --primary-color: #007bff;
        --secondary-color: #f8f9fa;

         
        --text-color-dark: #e4e6eb;
        --text-secondary-color-dark: #b0b3b8;
        --background-color-dark: #18191a;
        --secondary-background-color-dark: #212529;
        --primary-color-dark: #ffffff;
        --secondary-color-dark: #212529;
    }
    body {
        font-size: 1rem;
        font-weight: 400;
        line-height: 1.5;
        text-align: left;
    }

    html {
        background-color: var(--background-color) !important;
    }

    body::-webkit-scrollbar {
        width: .5em;
        height: .5em;
        background-color: var(--background-color);
    }
    
    ::-webkit-scrollbar-track {
        box-shadow: inset 0 0 6px var(--background-color);
        border-radius: 1rem;
    }
    
    ::-webkit-scrollbar-thumb {
        border-radius: 1rem;
        background-color: var(--secondary-color);
        outline: 1px solid var(--background-color);
    }

    #search-content::-webkit-scrollbar {
        width: .5em;
        height: .1em;
        background-color: var(--background-color);
    }
</style>

<meta name="description" content="">
<link rel="stylesheet" href="/css/single.css">


<script defer src="/fontawesome-5/all-5.15.4.js"></script>

  <title>
Predicting Energy Futures | Myles Kornfeld

  </title>
</head>

<body class="light" onload="loading()">
  
  
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>



<header>
    <nav class="pt-3 navbar navbar-expand-lg animate">
        <div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5">
            
            <a class="navbar-brand primary-font text-wrap" href="/">
                
                <img src="/fav.png" width="30" height="30"
                    class="d-inline-block align-top">
                Myles Kornfeld
                
            </a>

            
                <div>
                    <input id="search" autocomplete="off" class="form-control mr-sm-2 d-none d-md-block" placeholder="Search ..."
                        aria-label="Search" oninput="searchOnChange(event)">
                </div>
            

            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent"
                aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
                <svg aria-hidden="true" height="24" viewBox="0 0 16 16" version="1.1" width="24" data-view-component="true">
                    <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z"></path>
                </svg>
            </button>

            
            <div class="collapse navbar-collapse text-wrap primary-font" id="navbarContent">
                <ul class="navbar-nav ms-auto text-center">
                    
                        <li class="nav-item navbar-text d-block d-md-none">
                            <div class="nav-link">
                                <input id="search" autocomplete="off" class="form-control mr-sm-2" placeholder="Search ..." aria-label="Search" oninput="searchOnChange(event)">
                            </div>
                        </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#about" aria-label="about">
                            About Me
                        </a>
                    </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#experience"
                            aria-label="experience">
                            Experience
                        </a>
                    </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#education"
                            aria-label="education">
                            Education
                        </a>
                    </li>
                    

                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#achievements"
                            aria-label="achievements">
                            Achievements
                        </a>
                    </li>
                    

                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/#contact"
                            aria-label="contact">
                            Contact
                        </a>
                    </li>
                    

                    
                    
                    
                    
                    <li class="nav-item navbar-text">
                        <a class="nav-link" href="/blogs" title="Portfolio">
                            
                            Portfolio
                        </a>
                    </li>
                    
                    

                    
                    <li class="nav-item navbar-text">
                        
                        <div class="text-center">
                            <button id="theme-toggle">
                                <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                                </svg>
                                <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="5"></circle>
                                    <line x1="12" y1="1" x2="12" y2="3"></line>
                                    <line x1="12" y1="21" x2="12" y2="23"></line>
                                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                                    <line x1="1" y1="12" x2="3" y2="12"></line>
                                    <line x1="21" y1="12" x2="23" y2="12"></line>
                                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                                </svg>
                            </button>
                        </div>
                    </li>
                    

                </ul>

            </div>
        </div>
    </nav>
</header>
<div id="content">
<section id="single">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-sm-12 col-md-12 col-lg-9">
        <div class="pr-lg-4">
          <div class="title mb-5">
            <h1 class="text-center mb-4">Predicting Energy Futures</h1>
            <div class="text-center">
              Myles Kornfeld 
              <small>|</small>
              Jan 3, 2023
            </div>
          </div>
          
          <div class="featured-image">
            <img class="img-fluid" src="/images/nat_gas_fut_1f.png" alt="Predicting Energy Futures">
          </div>
          
          <article class="page-content  p-2">
          <h1 id="forecasting-energy-markets">Forecasting Energy Markets</h1>
<h2 id="introduction">Introduction</h2>
<p>Over the past several years, global events have rocked the energy markets: the Covid-19 pandemic caused the price of oil to crash, while a combination of inflation and the sanctions placed on Russia due to its invasion of Ukraine have caused the price of oil and natural gas to skyrocket. As a result, it is important to be able to forecast energy markets accurately despite global uncertainty.</p>
<p>With this in mind, my project aims at developing a tool to forecast energy markets consistently and accurately in a time-effective manner. This tool can help governments allocate resources efficiently and help investors optimize trading futures. Specifically, by pulling publicly available data, I will train different univariate models on past values to forecast future values.</p>
<h2 id="tools">Tools</h2>
<p>I will be creating these models using Python. In particular, I will be using the pandas and numpy libraries to clean the data, the requests and json libraries to pull and parse the data, and the sklearn library to prepare the data. I will be using a XGBoost regressor, a Support Vector regressor, and a Random Forest regressor to forecast the data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> pandas <span style="color:#66d9ef">as</span> pd
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#66d9ef">as</span> plt
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> itertools
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> math
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> datetime
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> xgboost <span style="color:#66d9ef">as</span> xgb
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> xgboost <span style="color:#f92672">import</span> XGBRegressor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.ensemble <span style="color:#f92672">import</span> RandomForestRegressor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.svm <span style="color:#f92672">import</span> SVR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sklearn
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> mean_squared_error
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> GridSearchCV
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> cross_val_score
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.model_selection <span style="color:#f92672">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> mean_absolute_error
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pylab <span style="color:#f92672">import</span> rcParams
</span></span><span style="display:flex;"><span>rcParams[<span style="color:#e6db74">&#39;figure.facecolor&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;white&#39;</span>
</span></span><span style="display:flex;"><span>rcParams[<span style="color:#e6db74">&#39;axes.facecolor&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;white&#39;</span>
</span></span><span style="display:flex;"><span>rcParams[<span style="color:#e6db74">&#39;figure.figsize&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">6</span>
</span></span></code></pre></div><h2 id="pulling-data-from-the-us-energy-information-administration">Pulling Data from the U.S. Energy Information Administration</h2>
<p>The U.S. Energy Information Administration (EIA) collects and disseminates energy data to the public to promote efficient markets, sound policy making, and public education. The EIA makes its data available through dashboards available here: <a href="https://www.eia.gov/tools/">https://www.eia.gov/tools/</a>. For people who want to pull data locally, the EIA provides documentation for their API here: <a href="https://www.eia.gov/opendata/documentation.php">https://www.eia.gov/opendata/documentation.php</a>. To pull the data, one needs to register an API key. I blurred mine out, but one can easily be obtained from their website. However, their API has several problems. The first is that when trying to determine which data to pull, the options are often hidden, making querying data tedious. Additionally, the maximum number of points that can be pulled per request is 5000 datapoints. If one wants to pull more data, they would either have to paginate or or filter their data in the API call, as opposed to in a dataframe tool, like Pandas, which would be typically more well known by the user. My first class, LoadQuery, addresses these issues.</p>
<p>The class LoadQuery begins by looping through the different pages available, from which the user can select which data they want while having all options available, and then choose which dataset they want to pull. Next, the user will choose the periodicity of the data, if it comes in multiple formats, as well as the type of data that they want to pull, again, if the data comes in mulitple formats. Once chosen, the program will then paginate through the queries until all data is pulled. The data is then turned into a Pandas dataframe format, which can be accessed through the <code>.df</code> attribute of the LoadQuery object. The dataframe will be indexed by date.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>date_switch <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;annual&#39;</span>:<span style="color:#e6db74">&#39;%Y&#39;</span>,
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;monthly&#39;</span>:<span style="color:#e6db74">&#39;%Y-%m&#39;</span>,
</span></span><span style="display:flex;"><span>                   <span style="color:#e6db74">&#39;daily&#39;</span>:<span style="color:#e6db74">&#39;%Y-%m-</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LoadQuery</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, header <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>,page <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>, key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>,data <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, frequency <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>,response <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, df <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, format <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>header <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://api.eia.gov/v2&#39;</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>page <span style="color:#f92672">=</span> page <span style="color:#75715e">##Which page you want to access. Created by running load_page</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>key<span style="color:#f92672">=</span> <span style="color:#75715e">#XXXXXXXXX</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>data <span style="color:#f92672">=</span> data <span style="color:#75715e">##The data you want to access with the query. Created by running choose_query</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>frequency <span style="color:#f92672">=</span> frequency
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>response <span style="color:#f92672">=</span> response
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> df
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>format <span style="color:#f92672">=</span> format
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">load_page</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">##When running load_page, this creates</span>
</span></span><span style="display:flex;"><span>        api_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>header<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>page<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>key
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(api_url)<span style="color:#75715e">#, verify = False)</span>
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;frequency&#39;</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> response[<span style="color:#e6db74">&#39;response&#39;</span>]<span style="color:#f92672">.</span>keys():
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;Choose your id&#39;</span>)
</span></span><span style="display:flex;"><span>            check <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> response[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;routes&#39;</span>]:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#34;id: &#34;</span>, i[<span style="color:#e6db74">&#39;id&#39;</span>], <span style="color:#e6db74">&#34; Name: &#34;</span>, i[<span style="color:#e6db74">&#39;name&#39;</span>],<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>                check<span style="color:#f92672">.</span>append(i[<span style="color:#e6db74">&#39;id&#39;</span>])
</span></span><span style="display:flex;"><span>            next_page <span style="color:#f92672">=</span> input()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> next_page <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> check:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#39;What you typed was not an option&#39;</span>)
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>load_page()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>page<span style="color:#f92672">+=</span><span style="color:#e6db74">&#39;/&#39;</span><span style="color:#f92672">+</span>next_page
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>load_page()
</span></span><span style="display:flex;"><span>        api_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>header<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>page<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>key
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(api_url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>response <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">choose_frequency</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(self<span style="color:#f92672">.</span>response[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;frequency&#39;</span>]) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>frequency <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>response[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;frequency&#39;</span>][<span style="color:#ae81ff">0</span>][<span style="color:#e6db74">&#39;id&#39;</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;Choose the frequency&#39;</span>)
</span></span><span style="display:flex;"><span>            check <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>response[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;frequency&#39;</span>]:
</span></span><span style="display:flex;"><span>                check<span style="color:#f92672">.</span>append(i[<span style="color:#e6db74">&#39;id&#39;</span>])
</span></span><span style="display:flex;"><span>                print(i[<span style="color:#e6db74">&#39;id&#39;</span>])
</span></span><span style="display:flex;"><span>            frequency <span style="color:#f92672">=</span> input()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> frequency <span style="color:#f92672">in</span> check:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>frequency <span style="color:#f92672">=</span> frequency
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#39;What you typed was not an option&#39;</span>)
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>choose_frequency()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">choose_data</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(self<span style="color:#f92672">.</span>response[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;data&#39;</span>]<span style="color:#f92672">.</span>keys()) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>data <span style="color:#f92672">=</span> list(self<span style="color:#f92672">.</span>response[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;data&#39;</span>]<span style="color:#f92672">.</span>keys())[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;Choose the data type&#39;</span>)
</span></span><span style="display:flex;"><span>            check <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>response[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;data&#39;</span>]<span style="color:#f92672">.</span>keys():
</span></span><span style="display:flex;"><span>                check<span style="color:#f92672">.</span>append(i)
</span></span><span style="display:flex;"><span>                print(i)
</span></span><span style="display:flex;"><span>            data <span style="color:#f92672">=</span> input()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> data <span style="color:#f92672">in</span> check:
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>data <span style="color:#f92672">=</span> data
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#39;What you typed was not an option&#39;</span>)
</span></span><span style="display:flex;"><span>                self<span style="color:#f92672">.</span>choose_data()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_info</span>(self):
</span></span><span style="display:flex;"><span>        api_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>header<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>page<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>key<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;data[]=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>data<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;frequency=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>frequency
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(api_url)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>response <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>json()    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_every_response</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>format <span style="color:#f92672">=</span> date_switch[self<span style="color:#f92672">.</span>frequency]
</span></span><span style="display:flex;"><span>        api_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>header<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>page<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/data&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>key<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;data[]=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>data<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;frequency=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>frequency
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(api_url)
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>        final <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;data&#39;</span>]
</span></span><span style="display:flex;"><span>        total <span style="color:#f92672">=</span> data[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;total&#39;</span>]
</span></span><span style="display:flex;"><span>        offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> total <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">5000</span>:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>response <span style="color:#f92672">=</span> final
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            num_loops <span style="color:#f92672">=</span> math<span style="color:#f92672">.</span>floor(total<span style="color:#f92672">/</span><span style="color:#ae81ff">5000</span>)
</span></span><span style="display:flex;"><span>            offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,num_loops):
</span></span><span style="display:flex;"><span>                api_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>header<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>page<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/data&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>key<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;data[]=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>data<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;frequency=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>frequency<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;offset=&#39;</span><span style="color:#f92672">+</span>str(offset)
</span></span><span style="display:flex;"><span>                response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(api_url)
</span></span><span style="display:flex;"><span>                data <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>                final <span style="color:#f92672">+=</span> data[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;data&#39;</span>]
</span></span><span style="display:flex;"><span>                offset <span style="color:#f92672">+=</span> <span style="color:#ae81ff">5000</span>
</span></span><span style="display:flex;"><span>                percent <span style="color:#f92672">=</span> (offset<span style="color:#f92672">-</span><span style="color:#ae81ff">5000</span>)<span style="color:#f92672">/</span>total<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%.2f</span><span style="color:#e6db74">&#34;</span><span style="color:#f92672">%</span>percent,<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">% o</span><span style="color:#e6db74">f the way done&#39;</span>)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>response <span style="color:#f92672">=</span> final
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_total_number_of_data_points</span>(self):
</span></span><span style="display:flex;"><span>        api_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>header<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>page<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/data&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>key<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;data[]=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>data<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;frequency=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>frequency
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(api_url)
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> response[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;total&#39;</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_df</span>(self):
</span></span><span style="display:flex;"><span>        api_url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>header<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>page<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/data&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>key<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;data[]=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>data<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;frequency=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>frequency
</span></span><span style="display:flex;"><span>        response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(api_url)
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> response<span style="color:#f92672">.</span>json()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data[<span style="color:#e6db74">&#39;response&#39;</span>][<span style="color:#e6db74">&#39;data&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">return_url</span>(self):
</span></span><span style="display:flex;"><span>        url <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>header<span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>page<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;/data&#34;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>key<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;data[]=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>data<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;&amp;frequency=&#39;</span><span style="color:#f92672">+</span>self<span style="color:#f92672">.</span>frequency
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> url
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_data_df</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(self<span style="color:#f92672">.</span>response)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_index</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df[<span style="color:#e6db74">&#39;period&#39;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_datetime(self<span style="color:#f92672">.</span>df[<span style="color:#e6db74">&#39;period&#39;</span>],format <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>format)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df[<span style="color:#e6db74">&#39;time_idx&#39;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DatetimeIndex(self<span style="color:#f92672">.</span>df[<span style="color:#e6db74">&#39;period&#39;</span>])
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>df<span style="color:#f92672">.</span>set_index(<span style="color:#e6db74">&#39;time_idx&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>df<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#39;time_idx&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run_all</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>load_page()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>choose_frequency()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>choose_data()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>create_info()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>create_every_response()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(self<span style="color:#f92672">.</span>response)<span style="color:#f92672">.</span>drop_duplicates()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>create_index()
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Data has been obtained&#39;</span>)
</span></span></code></pre></div><h2 id="building-the-models">Building the Models</h2>
<p>To build and determine the best model, I built the ForecastModel class below. A ForecastModel object takes four parameters: the data one wants to forecast which was pulled from the query, the number of past periods to train the models on, the number of periods to forecast, and the name of the column in the dataframe being passed that contains the data.</p>
<p>I perform a GridSearch across a Support Vector regressor, a XGBoost regressor, and a RandomForest regressor. First, I</p>
<p>To build the models, I first call the <code>shift_values()</code> method to shift the values being predicted up a row so that the features in each row will forecast the value for the next day. Next, I call <code>train_models()</code>, which calls the models and performs a GridSearch, trains each model on a 80/20 split, and then performs a forecast by using the datapoints forecasted as the features. I then store the error and the predictions for each model. Afterwards, I align the predictions with the dates they correspond to through <code>update_df()</code>.</p>
<p>Finally, I call <code>plot_best_model()</code> to plot with the smallest MAE, while plot_data() plots all three models trained from the GridSearch. Calling <code>find_best_model()</code> works through the above steps and plots the best model. Calling the regressors attribute will display the final models created for each regressor. Below, I work through two examples.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>params <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;Support Vector Regressor&#39;</span>:{<span style="color:#e6db74">&#34;C&#34;</span>: [<span style="color:#ae81ff">0.5</span>, <span style="color:#ae81ff">0.7</span>], <span style="color:#e6db74">&#39;kernel&#39;</span>:[<span style="color:#e6db74">&#39;rbf&#39;</span>, <span style="color:#e6db74">&#39;poly&#39;</span>]},
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;RandomForest&#39;</span>:{<span style="color:#e6db74">&#39;max_features&#39;</span>:[<span style="color:#ae81ff">1.0</span>,<span style="color:#e6db74">&#39;sqrt&#39;</span>],<span style="color:#e6db74">&#39;min_samples_split&#39;</span>:[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>],<span style="color:#e6db74">&#39;min_samples_leaf&#39;</span>:[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>],<span style="color:#e6db74">&#39;bootstrap&#39;</span>:[<span style="color:#66d9ef">True</span>,<span style="color:#66d9ef">False</span>]},
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#39;XGBoost&#39;</span>:{<span style="color:#e6db74">&#39;min_child_weight&#39;</span>: [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">9</span>],<span style="color:#e6db74">&#39;colsample_bytree&#39;</span>: [<span style="color:#ae81ff">0.2</span>, <span style="color:#ae81ff">0.4</span>, <span style="color:#ae81ff">0.6</span>],<span style="color:#e6db74">&#39;max_depth&#39;</span>: [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">9</span>]}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ForecastModel</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, df<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, num_shifts <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, num_predict <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, col <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>,
</span></span><span style="display:flex;"><span>                 error <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, test<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>, predictions <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, final_df <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, final_date <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, first_date <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>, regressors<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> df
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>col <span style="color:#f92672">=</span> col
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>num_shifts <span style="color:#f92672">=</span> num_shifts
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>num_predict <span style="color:#f92672">=</span> num_predict
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>data <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>shift_values()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>error <span style="color:#f92672">=</span> error
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>test <span style="color:#f92672">=</span> test
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>predictions <span style="color:#f92672">=</span> predictions
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>final_df <span style="color:#f92672">=</span> final_df
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>final_date <span style="color:#f92672">=</span> final_date
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>first_date <span style="color:#f92672">=</span> first_date
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>regressors <span style="color:#f92672">=</span> regressors
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">create_regressors</span>(self):
</span></span><span style="display:flex;"><span>        regressors <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;Support Vector Regressor&#39;</span>: [SVR()],
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;RandomForest&#39;</span>:[RandomForestRegressor()],
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;XGBoost&#39;</span>: [XGBRegressor()]
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>regressors <span style="color:#f92672">=</span> regressors
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">shift_values</span>(self):
</span></span><span style="display:flex;"><span>        df_dummy <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>df[[self<span style="color:#f92672">.</span>col]]<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>,self<span style="color:#f92672">.</span>num_shifts<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>            name <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>col <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;_shift &#34;</span> <span style="color:#f92672">+</span> str(i)
</span></span><span style="display:flex;"><span>            df_dummy[name] <span style="color:#f92672">=</span> df_dummy[self<span style="color:#f92672">.</span>col]<span style="color:#f92672">.</span>shift(i)
</span></span><span style="display:flex;"><span>        df_dummy[self<span style="color:#f92672">.</span>col] <span style="color:#f92672">=</span> df_dummy[self<span style="color:#f92672">.</span>col]<span style="color:#f92672">.</span>shift(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        df_dummy <span style="color:#f92672">=</span> df_dummy<span style="color:#f92672">.</span>dropna(how<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;any&#39;</span>,axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        y <span style="color:#f92672">=</span> df_dummy[self<span style="color:#f92672">.</span>col]
</span></span><span style="display:flex;"><span>        X <span style="color:#f92672">=</span> df_dummy<span style="color:#f92672">.</span>drop(self<span style="color:#f92672">.</span>col,axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> X,y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">train_models</span>(self):
</span></span><span style="display:flex;"><span>        X,y <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>shift_values()
</span></span><span style="display:flex;"><span>        X_train, X_test, y_train, y_test <span style="color:#f92672">=</span> train_test_split(X, y, test_size<span style="color:#f92672">=</span><span style="color:#ae81ff">0.2</span>, shuffle<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>        X_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(X_train)
</span></span><span style="display:flex;"><span>        X_test <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(X_test)
</span></span><span style="display:flex;"><span>        y_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(y_train)
</span></span><span style="display:flex;"><span>        y_test <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(y_test)
</span></span><span style="display:flex;"><span>        X_pred <span style="color:#f92672">=</span> X_test<span style="color:#f92672">.</span>copy()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>create_regressors()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> reg <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>regressors:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;Training &#39;</span><span style="color:#f92672">+</span>reg)
</span></span><span style="display:flex;"><span>            model <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>regressors[reg][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">#model.fit(X_train, y_train)</span>
</span></span><span style="display:flex;"><span>            grid <span style="color:#f92672">=</span> GridSearchCV(model, params[reg])
</span></span><span style="display:flex;"><span>            grid<span style="color:#f92672">.</span>fit(X_train, y_train)
</span></span><span style="display:flex;"><span>            model <span style="color:#f92672">=</span> grid<span style="color:#f92672">.</span>best_estimator_
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>regressors[reg][<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> model
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,len(X_pred)<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>                new <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict([X_pred[i]])
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>                    predictions <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([new[<span style="color:#ae81ff">0</span>]])
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                    predictions <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>append(predictions,np<span style="color:#f92672">.</span>array([new[<span style="color:#ae81ff">0</span>]]))
</span></span><span style="display:flex;"><span>                X_pred[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>concatenate([new,X_test[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>][:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]])
</span></span><span style="display:flex;"><span>            error <span style="color:#f92672">=</span> mean_absolute_error(y_test[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], predictions)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>regressors[reg]<span style="color:#f92672">.</span>append(error)
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>regressors[reg]<span style="color:#f92672">.</span>append(predictions)   
</span></span><span style="display:flex;"><span>            print(reg<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; trained&#39;</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>test <span style="color:#f92672">=</span> y_test
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">update_df</span>(self):
</span></span><span style="display:flex;"><span>        first_date <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>        final_date <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>        length <span style="color:#f92672">=</span> len(self<span style="color:#f92672">.</span>df[self<span style="color:#f92672">.</span>df[self<span style="color:#f92672">.</span>col] <span style="color:#f92672">==</span> self<span style="color:#f92672">.</span>test[<span style="color:#ae81ff">0</span>]]<span style="color:#f92672">.</span>index)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>,length):
</span></span><span style="display:flex;"><span>            x <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>df<span style="color:#f92672">.</span>index<span style="color:#f92672">.</span>get_loc(self<span style="color:#f92672">.</span>df[self<span style="color:#f92672">.</span>df[self<span style="color:#f92672">.</span>col] <span style="color:#f92672">==</span> self<span style="color:#f92672">.</span>test[<span style="color:#ae81ff">0</span>]]<span style="color:#f92672">.</span>index[i])
</span></span><span style="display:flex;"><span>            new <span style="color:#f92672">=</span> x <span style="color:#f92672">+</span> len(self<span style="color:#f92672">.</span>test) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>df<span style="color:#f92672">.</span>iloc[new][<span style="color:#e6db74">&#39;value&#39;</span>] <span style="color:#f92672">==</span> self<span style="color:#f92672">.</span>test[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]:
</span></span><span style="display:flex;"><span>                first_date <span style="color:#f92672">=</span> x
</span></span><span style="display:flex;"><span>                final_date <span style="color:#f92672">=</span> new <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>first_date <span style="color:#f92672">=</span> first_date
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>final_date <span style="color:#f92672">=</span> final_date
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>final_df <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>df<span style="color:#f92672">.</span>iloc[first_date:final_date][[self<span style="color:#f92672">.</span>col]]<span style="color:#f92672">.</span>copy()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>final_df[<span style="color:#e6db74">&#39;test&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>test[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> reg <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>regressors:
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>final_df[reg<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; preds&#39;</span>] <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>regressors[reg][<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_best_model</span>(self):
</span></span><span style="display:flex;"><span>        left <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>        right <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>        min_error <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>regressors[<span style="color:#e6db74">&#39;Support Vector Regressor&#39;</span>][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>        best_model_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Support Vector Regressor&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> reg <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>regressors:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>regressors[reg][<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> min_error:
</span></span><span style="display:flex;"><span>                min_error <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>regressors[reg][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>                best_model_name <span style="color:#f92672">=</span> reg
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        rcParams[<span style="color:#e6db74">&#39;figure.figsize&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>plot(self<span style="color:#f92672">.</span>df[self<span style="color:#f92672">.</span>col], label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Full Dataset&#39;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>plot(self<span style="color:#f92672">.</span>final_df[best_model_name<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; preds&#39;</span>], label <span style="color:#f92672">=</span> best_model_name<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Predictions&#39;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>        corr <span style="color:#f92672">=</span> str(round(self<span style="color:#f92672">.</span>final_df<span style="color:#f92672">.</span>corr()[best_model_name<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; preds&#39;</span>][<span style="color:#e6db74">&#39;value&#39;</span>],<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>        min_error_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39; MAE: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> min_error
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(best_model_name<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Predictions r^2: &#39;</span><span style="color:#f92672">+</span>corr<span style="color:#f92672">+</span>min_error_name)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>plot(self<span style="color:#f92672">.</span>df[self<span style="color:#f92672">.</span>col][self<span style="color:#f92672">.</span>first_date <span style="color:#f92672">-</span> left:self<span style="color:#f92672">.</span>final_date <span style="color:#f92672">+</span> right], label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Previous&#39;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>plot(self<span style="color:#f92672">.</span>final_df[best_model_name<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; preds&#39;</span>], label <span style="color:#f92672">=</span> best_model_name<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Predictions&#39;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>        corr <span style="color:#f92672">=</span> str(round(self<span style="color:#f92672">.</span>final_df<span style="color:#f92672">.</span>corr()[reg<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; preds&#39;</span>][<span style="color:#e6db74">&#39;value&#39;</span>],<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>title(best_model_name<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Predictions r^2: &#39;</span><span style="color:#f92672">+</span>corr<span style="color:#f92672">+</span>min_error_name)
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>        plt<span style="color:#f92672">.</span>show()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">find_best_model</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>train_models()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>update_df()
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>plot_best_model()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_data</span>(self):
</span></span><span style="display:flex;"><span>        left <span style="color:#f92672">=</span> <span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>        right <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> reg <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>regressors:
</span></span><span style="display:flex;"><span>            min_error <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39; MAE: </span><span style="color:#e6db74">%.3f</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>regressors[reg][<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            rcParams[<span style="color:#e6db74">&#39;figure.figsize&#39;</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>            plt<span style="color:#f92672">.</span>plot(self<span style="color:#f92672">.</span>df[self<span style="color:#f92672">.</span>col][self<span style="color:#f92672">.</span>first_date <span style="color:#f92672">-</span> left:self<span style="color:#f92672">.</span>final_date <span style="color:#f92672">+</span> right], label <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Previous&#39;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;black&#39;</span>)
</span></span><span style="display:flex;"><span>            plt<span style="color:#f92672">.</span>plot(self<span style="color:#f92672">.</span>final_df[reg<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; preds&#39;</span>], label <span style="color:#f92672">=</span> reg<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Predictions&#39;</span>, color <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;blue&#39;</span>)
</span></span><span style="display:flex;"><span>            corr <span style="color:#f92672">=</span> str(round(self<span style="color:#f92672">.</span>final_df<span style="color:#f92672">.</span>corr()[reg<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; preds&#39;</span>][<span style="color:#e6db74">&#39;value&#39;</span>],<span style="color:#ae81ff">3</span>))
</span></span><span style="display:flex;"><span>            plt<span style="color:#f92672">.</span>title(reg<span style="color:#f92672">+</span><span style="color:#e6db74">&#39; Predictions r^2: &#39;</span><span style="color:#f92672">+</span>corr<span style="color:#f92672">+</span>min_error)
</span></span><span style="display:flex;"><span>            plt<span style="color:#f92672">.</span>legend()
</span></span><span style="display:flex;"><span>            plt<span style="color:#f92672">.</span>show()
</span></span></code></pre></div><h2 id="forecasting-natural-gas-futures">Forecasting Natural Gas Futures</h2>
<p>Below, I walk through the process outlined above to forecast natural gas futures. Specifically, I will be forecasting the Contract 1 futures prices. Because natural gas contracts expire three business days prior to the first calendar day of the delivery month, Contract 1 contains the calendar month following the trade date. Information can be found at this link: <a href="https://www.eia.gov/dnav/ng/TblDefs/ng_pri_fut_tbldef2.asp">https://www.eia.gov/dnav/ng/TblDefs/ng_pri_fut_tbldef2.asp</a>.</p>
<p>Below, I create a LoadQuery object to pull the data that I want to forecast.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>natural_gas_query <span style="color:#f92672">=</span> LoadQuery()
</span></span><span style="display:flex;"><span>natural_gas_query<span style="color:#f92672">.</span>run_all()
</span></span></code></pre></div><pre tabindex="0"><code>Choose your id
id:  coal  Name:  Coal
id:  crude-oil-imports  Name:  Crude Oil Imports
id:  electricity  Name:  Electricity
id:  international  Name:  International
id:  natural-gas  Name:  Natural Gas
id:  nuclear-outages  Name:  Nuclear Outages
id:  petroleum  Name:  Petroleum
id:  seds  Name:  State Energy Data System (SEDS)
id:  steo  Name:  Short Term Energy Outlook
id:  densified-biomass  Name:  Densified Biomass
id:  total-energy  Name:  Total Energy
id:  aeo  Name:  Annual Energy Outlook
id:  ieo  Name:  International Energy Outlook
id:  co2-emissions  Name:  State CO2 Emissions
natural-gas
Choose your id
id:  sum  Name:  Summary
id:  pri  Name:  Prices
id:  enr  Name:  Exploration and Reserves
id:  prod  Name:  Production
id:  move  Name:  Imports and Exports/Pipelines
id:  stor  Name:  Storage
id:  cons  Name:  Consumption / End Use
pri
Choose your id
id:  sum  Name:  Natural Gas Prices
id:  fut  Name:  Natural Gas Spot and Futures Prices (NYMEX)
id:  rescom  Name:  Average Price of Natural Gas Delivered to Residential and Commercial Consumers by Local Distribution and Marketers in Selected States
fut
Choose the frequency
weekly
monthly
daily
annual
daily
11.82 % of the way done
23.64 % of the way done
35.46 % of the way done
47.28 % of the way done
59.10 % of the way done
70.92 % of the way done
82.74 % of the way done
94.56 % of the way done
Data has been obtained
</code></pre><p>Now that the data has been obtained, I call the dataframe to see the different features and how to filter for Contract 1.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>natural_gas_query<span style="color:#f92672">.</span>df[<span style="color:#e6db74">&#39;series-description&#39;</span>]<span style="color:#f92672">.</span>unique()
</span></span></code></pre></div><pre tabindex="0"><code>array([&#39;Natural Gas Futures Contract 4 (Dollars per Million Btu)&#39;,
       &#39;Natural Gas Futures Contract 2 (Dollars per Million Btu)&#39;,
       &#39;Natural Gas Futures Contract 1 (Dollars per Million Btu)&#39;,
       &#39;Natural Gas Futures Contract 3 (Dollars per Million Btu)&#39;,
       &#39;Henry Hub Natural Gas Spot Price (Dollars per Million Btu)&#39;],
      dtype=object)
</code></pre><p>I will filter on the series description &lsquo;Natural Gas Futures Contract 1 (Dollars per Million Btu)&rsquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>series_desc <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Natural Gas Futures Contract 1 (Dollars per Million Btu)&#39;</span>
</span></span><span style="display:flex;"><span>natural_gas_data <span style="color:#f92672">=</span> natural_gas_query<span style="color:#f92672">.</span>df[(natural_gas_query<span style="color:#f92672">.</span>df[<span style="color:#e6db74">&#39;series-description&#39;</span>] <span style="color:#f92672">==</span> series_desc)]
</span></span><span style="display:flex;"><span>natural_gas_data <span style="color:#f92672">=</span> natural_gas_data<span style="color:#f92672">.</span>dropna()
</span></span><span style="display:flex;"><span>natural_gas_data<span style="color:#f92672">.</span>head()
</span></span></code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">time_idx</th>
<th style="text-align:left">period</th>
<th style="text-align:left">duoarea</th>
<th style="text-align:left">area-name</th>
<th style="text-align:left">product</th>
<th style="text-align:left">product-name</th>
<th style="text-align:left">process</th>
<th style="text-align:left">process-name</th>
<th style="text-align:left">series</th>
<th style="text-align:left">series-description</th>
<th style="text-align:right">value</th>
<th style="text-align:left">units</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1993-12-20 00:00:00</td>
<td style="text-align:left">1993-12-20 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPG0</td>
<td style="text-align:left">Natural Gas</td>
<td style="text-align:left">PE4</td>
<td style="text-align:left">Future Contract 4</td>
<td style="text-align:left">RNGC4</td>
<td style="text-align:left">Natural Gas Futures Contract 4 (Dollars per Million Btu)</td>
<td style="text-align:right">1.894</td>
<td style="text-align:left">$/MMBTU</td>
</tr>
<tr>
<td style="text-align:left">1993-12-21 00:00:00</td>
<td style="text-align:left">1993-12-21 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPG0</td>
<td style="text-align:left">Natural Gas</td>
<td style="text-align:left">PE4</td>
<td style="text-align:left">Future Contract 4</td>
<td style="text-align:left">RNGC4</td>
<td style="text-align:left">Natural Gas Futures Contract 4 (Dollars per Million Btu)</td>
<td style="text-align:right">1.83</td>
<td style="text-align:left">$/MMBTU</td>
</tr>
<tr>
<td style="text-align:left">1993-12-22 00:00:00</td>
<td style="text-align:left">1993-12-22 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPG0</td>
<td style="text-align:left">Natural Gas</td>
<td style="text-align:left">PE4</td>
<td style="text-align:left">Future Contract 4</td>
<td style="text-align:left">RNGC4</td>
<td style="text-align:left">Natural Gas Futures Contract 4 (Dollars per Million Btu)</td>
<td style="text-align:right">1.859</td>
<td style="text-align:left">$/MMBTU</td>
</tr>
<tr>
<td style="text-align:left">1993-12-23 00:00:00</td>
<td style="text-align:left">1993-12-23 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPG0</td>
<td style="text-align:left">Natural Gas</td>
<td style="text-align:left">PE4</td>
<td style="text-align:left">Future Contract 4</td>
<td style="text-align:left">RNGC4</td>
<td style="text-align:left">Natural Gas Futures Contract 4 (Dollars per Million Btu)</td>
<td style="text-align:right">1.895</td>
<td style="text-align:left">$/MMBTU</td>
</tr>
<tr>
<td style="text-align:left">1993-12-27 00:00:00</td>
<td style="text-align:left">1993-12-27 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPG0</td>
<td style="text-align:left">Natural Gas</td>
<td style="text-align:left">PE4</td>
<td style="text-align:left">Future Contract 4</td>
<td style="text-align:left">RNGC4</td>
<td style="text-align:left">Natural Gas Futures Contract 4 (Dollars per Million Btu)</td>
<td style="text-align:right">1.965</td>
<td style="text-align:left">$/MMBTU</td>
</tr>
</tbody>
</table>
<p>I create the model by passing the dataframe <code>natural_gas_data</code>, train the model by having the previous 50 days predict the next day, forecast the next 150 days, and use the data in the column &ldquo;value&rdquo;.</p>
<p>After training the models, the best model is graphed below. The Support Vector regressor was the best model, and had an r<sup>2</sup> value of 0.982 with the testing data and a mean average error of 0.190.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>natural_gas_forecast <span style="color:#f92672">=</span> ForecastModel(df <span style="color:#f92672">=</span> natural_gas_data, num_shifts <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>, num_predict <span style="color:#f92672">=</span> <span style="color:#ae81ff">150</span>, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;value&#39;</span>)
</span></span><span style="display:flex;"><span>natural_gas_forecast<span style="color:#f92672">.</span>find_best_model()
</span></span></code></pre></div><pre tabindex="0"><code>Training Support Vector Regressor
Support Vector Regressor trained
Training RandomForest
RandomForest trained
Training XGBoost
XGBoost trained
</code></pre><!-- ![title](/images/nat_gas_fut_1.png)
![title](/images/nat_gas_fut_2.png) -->
  <p align="center">
    <img src="/images/nat_gas_fut_1f.png" width="700">
  </p>
  <p align="center">
    <img src="/images/nat_gas_fut_2f.png" width="700">
  </p>
<p>Below I plot the best predictions for each of the different regressors. In addition to the Suport Vector regressor, the XGBoost regressor closely predicted the test data, with an r<sup>2</sup> of 0.979 and an MAE of 0.218. The RandomForest regressor, however, clearly did not capture the trends in the data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>natural_gas_forecast<span style="color:#f92672">.</span>plot_data()
</span></span></code></pre></div><p align="center">
  <img src="/images/nat_gas_fut_1f.png" width="700">
</p>
<p align="center">
  <img src="/images/nat_gas_fut_rff.png" width="700">
</p>
<p align="center">
  <img src="/images/nat_gas_fut_xgboostf.png" width="700">
</p>
<h2 id="forecasting-petroleum-futures">Forecasting Petroleum Futures</h2>
<p>I&rsquo;ll now run through the same process by forecasting New York Harbor No. 2 Heating Oil Future Contract 1.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>petroleum_forecast <span style="color:#f92672">=</span> LoadQuery()
</span></span><span style="display:flex;"><span>petroleum_forecast<span style="color:#f92672">.</span>run_all()
</span></span></code></pre></div><pre tabindex="0"><code>Choose your id
id:  coal  Name:  Coal
id:  crude-oil-imports  Name:  Crude Oil Imports
id:  electricity  Name:  Electricity
id:  international  Name:  International
id:  natural-gas  Name:  Natural Gas
id:  nuclear-outages  Name:  Nuclear Outages
id:  petroleum  Name:  Petroleum
id:  seds  Name:  State Energy Data System (SEDS)
id:  steo  Name:  Short Term Energy Outlook
id:  densified-biomass  Name:  Densified Biomass
id:  total-energy  Name:  Total Energy
id:  aeo  Name:  Annual Energy Outlook
id:  ieo  Name:  International Energy Outlook
id:  co2-emissions  Name:  State CO2 Emissions
petroleum
Choose your id
id:  sum  Name:  Summary
id:  pri  Name:  Prices
id:  crd  Name:  Crude Reserves and Production
id:  pnp  Name:  Refining and Processing
id:  move  Name:  Imports/Exports and Movements
id:  stoc  Name:  Stocks
id:  cons  Name:  Consumption/Sales
pri
Choose your id
id:  gnd  Name:  Weekly Retail Gasoline and Diesel Prices
id:  spt  Name:  Spot Prices
id:  fut  Name:  NYMEX Futures Prices
id:  wfr  Name:  Weekly Heating Oil and Propane Prices (October - March)
id:  refmg  Name:  Refiner Gasoline Prices by Grade and Sales Type
id:  refmg2  Name:  U.S. Refiner Gasoline Prices by Formulation, Grade, Sales Type
id:  refoth  Name:  Refiner Petroleum Product Prices by Sales Type
id:  allmg  Name:  Gasoline Prices by Formulation, Grade, Sales Type
id:  dist  Name:  No. 2 Distillate Prices by Sales Type
id:  prop  Name:  Propane (Consumer Grade) Prices by Sales Type
id:  resid  Name:  Residual Fuel Oil Prices by Sales Type
id:  dfp1  Name:  Domestic Crude Oil First Purchase Prices by Area
id:  dfp2  Name:  Domestic Crude Oil First Purchase Prices for Selected Crude Streams
id:  dfp3  Name:  Domestic Crude Oil First Purchase Prices by API Gravity
id:  rac2  Name:  Refiner Acquisition Cost of Crude Oil
id:  imc1  Name:  F.O.B. Costs of Imported Crude Oil by Area
id:  imc2  Name:  F.O.B. Costs of Imported Crude Oil for Selected Crude Streams
id:  imc3  Name:  F.O.B. Costs of Imported Crude Oil by API Gravity
id:  land1  Name:  Landed Costs of Imported Crude by Area
id:  land2  Name:  Landed Costs of Imported Crude for Selected Crude Streams
id:  land3  Name:  Landed Costs of Imported Crude by API Gravity
id:  ipct  Name:  Percentages of Total Imported Crude Oil by API Gravity
fut
Choose the frequency
weekly
daily
monthly
annual
daily
3.68 % of the way done
7.36 % of the way done
11.05 % of the way done
14.73 % of the way done
18.41 % of the way done
22.09 % of the way done
25.78 % of the way done
29.46 % of the way done
33.14 % of the way done
36.82 % of the way done
40.50 % of the way done
44.19 % of the way done
47.87 % of the way done
51.55 % of the way done
55.23 % of the way done
58.91 % of the way done
62.60 % of the way done
66.28 % of the way done
69.96 % of the way done
73.64 % of the way done
77.33 % of the way done
81.01 % of the way done
84.69 % of the way done
88.37 % of the way done
92.05 % of the way done
95.74 % of the way done
99.42 % of the way done
Data has been obtained
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>petroleum_forecast<span style="color:#f92672">.</span>df<span style="color:#f92672">.</span>head()
</span></span></code></pre></div><table>
<thead>
<tr>
<th style="text-align:left">time_idx</th>
<th style="text-align:left">period</th>
<th style="text-align:left">duoarea</th>
<th style="text-align:left">area-name</th>
<th style="text-align:left">product</th>
<th style="text-align:left">product-name</th>
<th style="text-align:left">process</th>
<th style="text-align:left">process-name</th>
<th style="text-align:left">series</th>
<th style="text-align:left">series-description</th>
<th style="text-align:right">value</th>
<th style="text-align:left">units</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1980-01-02 00:00:00</td>
<td style="text-align:left">1980-01-02 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPD2F</td>
<td style="text-align:left">No 2 Fuel Oil / Heating Oil</td>
<td style="text-align:left">PE1</td>
<td style="text-align:left">Future Contract 1</td>
<td style="text-align:left">EER_EPD2F_PE1_Y35NY_DPG</td>
<td style="text-align:left">New York Harbor No. 2 Heating Oil Future Contract 1 (Dollars per Gallon)</td>
<td style="text-align:right">0.821</td>
<td style="text-align:left">$/GAL</td>
</tr>
<tr>
<td style="text-align:left">1980-01-02 00:00:00</td>
<td style="text-align:left">1980-01-02 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPD2F</td>
<td style="text-align:left">No 2 Fuel Oil / Heating Oil</td>
<td style="text-align:left">PE3</td>
<td style="text-align:left">Future Contract 3</td>
<td style="text-align:left">EER_EPD2F_PE3_Y35NY_DPG</td>
<td style="text-align:left">New York Harbor No. 2 Heating Oil Future Contract 3 (Dollars per Gallon)</td>
<td style="text-align:right">0.89</td>
<td style="text-align:left">$/GAL</td>
</tr>
<tr>
<td style="text-align:left">1980-01-03 00:00:00</td>
<td style="text-align:left">1980-01-03 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPD2F</td>
<td style="text-align:left">No 2 Fuel Oil / Heating Oil</td>
<td style="text-align:left">PE1</td>
<td style="text-align:left">Future Contract 1</td>
<td style="text-align:left">EER_EPD2F_PE1_Y35NY_DPG</td>
<td style="text-align:left">New York Harbor No. 2 Heating Oil Future Contract 1 (Dollars per Gallon)</td>
<td style="text-align:right">0.827</td>
<td style="text-align:left">$/GAL</td>
</tr>
<tr>
<td style="text-align:left">1980-01-04 00:00:00</td>
<td style="text-align:left">1980-01-04 00:00:00</td>
<td style="text-align:left">Y35NY</td>
<td style="text-align:left">NEW YORK CITY</td>
<td style="text-align:left">EPD2F</td>
<td style="text-align:left">No 2 Fuel Oil / Heating Oil</td>
<td style="text-align:left">PE3</td>
<td style="text-align:left">Future Contract 3</td>
<td style="text-align:left">EER_EPD2F_PE3_Y35NY_DPG</td>
<td style="text-align:left">New York Harbor No. 2 Heating Oil Future Contract 3 (Dollars per Gallon)</td>
<td style="text-align:right">0.88</td>
<td style="text-align:left">$/GAL</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>petroleum_forecast<span style="color:#f92672">.</span>df[<span style="color:#e6db74">&#39;series-description&#39;</span>]<span style="color:#f92672">.</span>unique()
</span></span></code></pre></div><pre tabindex="0"><code>array([&#39;New York Harbor No. 2 Heating Oil Future Contract 3 (Dollars per Gallon)&#39;,
       &#39;New York Harbor No. 2 Heating Oil Future Contract 1 (Dollars per Gallon)&#39;,
       &#39;Cushing, OK Crude Oil Future Contract 3 (Dollars per Barrel)&#39;,
       &#39;Cushing, OK Crude Oil Future Contract 1 (Dollars per Barrel)&#39;,
       &#39;New York Harbor Regular Gasoline Future Contract 3 (Dollars per Gallon)&#39;,
       &#39;New York Harbor Regular Gasoline Future Contract 1 (Dollars per Gallon)&#39;,
       &#39;Cushing, OK Crude Oil Future Contract 2 (Dollars per Barrel)&#39;,
       &#39;Cushing, OK Crude Oil Future Contract 4 (Dollars per Barrel)&#39;,
       &#39;Mont Belvieu, Tx Propane Future Contract 1 (Dollars per Gallon)&#39;,
       &#39;Mont Belvieu, Tx Propane Future Contract 4 (Dollars per Gallon)&#39;,
       &#39;New York Harbor No. 2 Heating Oil Future Contract 4 (Dollars per Gallon)&#39;,
       &#39;New York Harbor Regular Gasoline Future Contract 2 (Dollars per Gallon)&#39;,
       &#39;New York Harbor Regular Gasoline Future Contract 4 (Dollars per Gallon)&#39;,
       &#39;New York Harbor No. 2 Heating Oil Future Contract 2 (Dollars per Gallon)&#39;,
       &#39;Mont Belvieu, Tx Propane Future Contract 2 (Dollars per Gallon)&#39;,
       &#39;Mont Belvieu, Tx Propane Future Contract 3 (Dollars per Gallon)&#39;,
       &#39;New York Harbor Reformulated RBOB Regular Gasoline Future Contract 2 (Dollars per Gallon)&#39;,
       &#39;New York Harbor Reformulated RBOB Regular Gasoline Future Contract 1 (Dollars per Gallon)&#39;,
       &#39;New York Harbor Reformulated RBOB Regular Gasoline Future Contract 4 (Dollars per Gallon)&#39;,
       &#39;New York Harbor Reformulated RBOB Regular Gasoline Future Contract 3 (Dollars per Gallon)&#39;],
      dtype=object)
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>petreoleum_forecast_data<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> petroleum_forecast<span style="color:#f92672">.</span>df[petroleum_forecast<span style="color:#f92672">.</span>df[<span style="color:#e6db74">&#39;series-description&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;New York Harbor No. 2 Heating Oil Future Contract 1 (Dollars per Gallon)&#39;</span>]
</span></span><span style="display:flex;"><span>petreoleum_forecast_data<span style="color:#f92672">.</span>df <span style="color:#f92672">=</span> petreoleum_forecast_data<span style="color:#f92672">.</span>df<span style="color:#f92672">.</span>dropna()
</span></span></code></pre></div><p>After training the different models, this time the XGBoost regressor had the smallest MAE at 0.088 and the largest r<sup>2</sup> at 0.982 for the testing data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>petroleum_forecast_model <span style="color:#f92672">=</span> ForecastModel(df <span style="color:#f92672">=</span> petreoleum_forecast_data<span style="color:#f92672">.</span>df, num_shifts <span style="color:#f92672">=</span> <span style="color:#ae81ff">50</span>, num_predict <span style="color:#f92672">=</span> <span style="color:#ae81ff">150</span>, col <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;value&#39;</span>)
</span></span><span style="display:flex;"><span>petroleum_forecast_model<span style="color:#f92672">.</span>find_best_model()
</span></span></code></pre></div><pre tabindex="0"><code>Training Support Vector Regressor
Support Vector Regressor trained
Training RandomForest
RandomForest trained
Training XGBoost
XGBoost trained
</code></pre><p align="center">
  <img src="/images/pet_fut_11.png" width="700">
</p>
<p align="center">
  <img src="/images/pet_fut_zoom.png" width="700">
</p>
<p>Looking at the rest of the models, we see that the Support Vector regressor also predicted the data very well, while the RandomForest regressor was unable to capture the trend.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span>petroleum_forecast_model<span style="color:#f92672">.</span>plot_data()
</span></span></code></pre></div><p align="center">
  <img src="/images/pet_fut_svr.png" width="700">
</p>
<p align="center">
  <img src="/images/pet_fut_rf.png" width="700">
</p>
<p align="center">
  <img src="/images/pet_fut_zoom.png" width="700">
</p>
<h2 id="conclusions-and-next-steps">Conclusions and Next Steps</h2>
<p>Taking a look at the natural gas and petroleum futures predictions, we are able to see that the models captured the volatility due to the Covid-19 pandemic and the invasion of Ukraine in their forecasting. As a result, it seems that univariate time-series models can be useful and cost-effective in forecasting markets.</p>
<p>I believe that there are several ways to improve this project. First, when testing the models across other datasets, the models were occasionally unable to capture seasonality in the data. As a result, when data appears more seasonal, performing a seasonality decomposition could increase model performance. Secondly, there were some datasets where models had more difficulty making predictions. Creating a multivariate model that incorporates features such as GDP, local and international conflicts, different weather events, and location could improve model performance as well.</p>
<!--
## Paragraph

Xerum, quo qui aut unt expliquam qui dolut labo. Aque venitatiusda cum, voluptionse latur sitiae dolessi aut parist aut dollo enim qui voluptate ma dolestendit peritin re plis aut quas inctum laceat est volestemque commosa as cus endigna tectur, offic to cor sequas etum rerum idem sintibus eiur? Quianimin porecus evelectur, cum que nis nust voloribus ratem aut omnimi, sitatur? Quiatem. Nam, omnis sum am facea corem alique molestrunt et eos evelece arcillit ut aut eos eos nus, sin conecerem erum fuga. Ri oditatquam, ad quibus unda veliamenimin cusam et facea ipsamus es exerum sitate dolores editium rerore eost, temped molorro ratiae volorro te reribus dolorer sperchicium faceata tiustia prat.

Itatur? Quiatae cullecum rem ent aut odis in re eossequodi nonsequ idebis ne sapicia is sinveli squiatum, core et que aut hariosam ex eat.

## Blockquotes

The blockquote element represents content that is quoted from another source, optionally with a citation which must be within a `footer` or `cite` element, and optionally with in-line changes such as annotations and abbreviations.

### Blockquote without attribution

> Tiam, ad mint andaepu dandae nostion secatur sequo quae.
> **Note** that you can use _Markdown syntax_ within a blockquote.

### Blockquote with attribution

> Don't communicate by sharing memory, share memory by communicating.</p>
>  <cite>Rob Pike[^1]</cite>

[^1]: The above quote is excerpted from Rob Pike's [talk](https://www.youtube.com/watch?v=PAAkCSZUG1c) during Gopherfest, November 18, 2015.

## Tables

Tables aren't part of the core Markdown spec, but Hugo supports supports them out-of-the-box.

| Name  | Age |
| ----- | --- |
| Bob   | 27  |
| Alice | 23  |

### Inline Markdown within tables

| Inline&nbsp;&nbsp;&nbsp; | Markdown&nbsp;&nbsp;&nbsp; | In&nbsp;&nbsp;&nbsp;                | Table  |
| ------------------------ | -------------------------- | ----------------------------------- | ------ |
| _italics_                | **bold**                   | ~~strikethrough~~&nbsp;&nbsp;&nbsp; | `code` |

## Code Blocks

### Code block with backticks

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Example HTML5 Document</title>
  </head>
  <body>
    <p>Test</p>
  </body>
</html>
```

### Code block indented with four spaces

    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <title>Example HTML5 Document</title>
    </head>
    <body>
      <p>Test</p>
    </body>
    </html>

### Code block with Hugo's internal highlight shortcode

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">title</span>&gt;Example HTML5 Document&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">p</span>&gt;Test&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;</span></span></code></pre></div>

## List Types

### Ordered List

1. First item
2. Second item
3. Third item

### Unordered List

- List item
- Another item
- And another item

### Nested list

- Item
  1. First Sub-item
  2. Second Sub-item

## Headings

The following HTML `<h1>``<h6>` elements represent six levels of section headings. `<h1>` is the highest section level while `<h6>` is the lowest.

# H1

## H2

### H3

#### H4

##### H5

###### H6

## Other Elements  abbr, sub, sup, kbd, mark

<abbr title="Graphics Interchange Format">GIF</abbr> is a bitmap image format.

H<sub>2</sub>O

X<sup>n</sup> + Y<sup>n</sup> = Z<sup>n</sup>

Press <kbd><kbd>CTRL</kbd>+<kbd>ALT</kbd>+<kbd>Delete</kbd></kbd> to end the session.

Most <mark>salamanders</mark> are nocturnal, and hunt for insects, worms, and other small creatures. -->

          </article>
        </div>
      </div>
      <div class="col-sm-12 col-md-12 col-lg-3">
        <div class="sticky-sidebar">
          
          <aside class="toc">
              <h5>
                Table Of Contents
              </h5>
              <div class="toc-content">
                <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#tools">Tools</a></li>
    <li><a href="#pulling-data-from-the-us-energy-information-administration">Pulling Data from the U.S. Energy Information Administration</a></li>
    <li><a href="#building-the-models">Building the Models</a></li>
    <li><a href="#forecasting-natural-gas-futures">Forecasting Natural Gas Futures</a></li>
    <li><a href="#forecasting-petroleum-futures">Forecasting Petroleum Futures</a></li>
    <li><a href="#conclusions-and-next-steps">Conclusions and Next Steps</a></li>
  </ul>
</nav>
              </div>
          </aside>
          

          
          <aside class="tags">
            <h5>Tags</h5>
            <ul class="tags-ul list-unstyled list-inline">
              
              <li class="list-inline-item"><a href="https://hugo-profile.netlify.app/tags/forecasting" target="_blank">Forecasting</a></li>
              
              <li class="list-inline-item"><a href="https://hugo-profile.netlify.app/tags/energy" target="_blank">Energy</a></li>
              
              <li class="list-inline-item"><a href="https://hugo-profile.netlify.app/tags/regression" target="_blank">Regression</a></li>
              
            </ul>
          </aside>
          

          
          <aside class="social">
            <h5>Social</h5>
            <div class="social-content">
              <ul class="list-inline">
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://twitter.com/share?text=Predicting%20Energy%20Futures&url=https%3a%2f%2fhugo-profile.netlify.app%2fblogs%2fforecasting_energy_markets%2f">
                    <i class="fab fa-twitter"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href="https://api.whatsapp.com/send?text=Predicting%20Energy%20Futures: https%3a%2f%2fhugo-profile.netlify.app%2fblogs%2fforecasting_energy_markets%2f">
                    <i class="fab fa-whatsapp"></i>
                  </a>
                </li>
                <li class="list-inline-item text-center">
                  <a target="_blank" href="mailto:?subject=Predicting%20Energy%20Futures&amp;body=Check out this site https%3a%2f%2fhugo-profile.netlify.app%2fblogs%2fforecasting_energy_markets%2f">
                    <i class="fa fa-envelope"></i>
                  </a>
                </li>
              </ul>
            </div>
          </aside>
          
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-12 col-md-12 col-lg-9 p-4">
        
      </div>
    </div>
  </div>
  <button class="p-2 px-3" onclick="topFunction()" id="topScroll">
    <i class="fas fa-angle-up"></i>
  </button>
</section>

<script>
  var topScroll = document.getElementById("topScroll");
  window.onscroll = function() {scrollFunction()};

  function scrollFunction() {
    if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
      topScroll.style.display = "block";
    } else {
      topScroll.style.display = "none";
    }
  }

  function topFunction() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
  }
</script>


  </div><footer>
    <div class="container py-3" id="recent-posts">
    
</div><div class="text-center pt-2">
    
    <span class="px-1">
        <a href="https://github.com/mkornfeld" aria-label="github">
            <svg xmlns="http://www.w3.org/2000/svg" width="2.7em" height="2.7em" viewBox="0 0 1792 1792">
                <path
                    d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5t-203.5 84.5h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105 20.5-150.5q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27t-83.5-38.5-86-13.5q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5-55.5-62.5q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5h-224q-119 0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5 84.5t84.5 203.5z" />

                <metadata>
                    <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
                        xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#" xmlns:dc="http://purl.org/dc/elements/1.1/">
                        <rdf:Description about="https://iconscout.com/legal#licenses"
                            dc:title="Github, Online, Project, Hosting, Square"
                            dc:description="Github, Online, Project, Hosting, Square" dc:publisher="Iconscout"
                            dc:date="2016-12-14" dc:format="image/svg+xml" dc:language="en">
                            <dc:creator>
                                <rdf:Bag>
                                    <rdf:li>Font Awesome</rdf:li>
                                </rdf:Bag>
                            </dc:creator>
                        </rdf:Description>
                    </rdf:RDF>
                </metadata>
            </svg>
        </a>
    </span>
    

    
    <span class="px-1">
        <a href="https://linkedin.com/in/myleskornfeld/" aria-label="linkedin">
            <svg xmlns="http://www.w3.org/2000/svg" width='2.4em' height='2.4em' fill="#fff" aria-label="LinkedIn"
                viewBox="0 0 512 512">
                <rect width="512" height="512" fill="#0077b5" rx="15%" />
                <circle cx="142" cy="138" r="37" />
                <path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198" />
                <path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32" />
            </svg>
        </a>
    </span>
    

    

    

    
</div><div class="container py-4">
    <div class="row justify-content-center">
        <div class="col-md-4 text-center">
            <div class="pb-2">
                <a href="https://hugo-profile.netlify.app" title="Myles Kornfeld">
                    <img alt="Footer logo" src="/fav.png"
                        height="40px" width="40px">
                </a>
            </div>
            &copy; 2023  All Rights Reserved
            <div class="text-secondary">
                Made with
                <span class="text-danger">
                    &#10084;
                </span>
                and
                <a href="https://github.com/gurusabarish/hugo-profile" target="_blank"
                    title="Designed and developed by gurusabarish">
                    Hugo Profile
                </a>
            </div>
        </div>
    </div>
</div></footer><script src="/bootstrap-5/js/bootstrap.bundle.min.js"></script>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })

</script>

<script>
    let loadingIcons;

    function loading() {
        myVar = setTimeout(showPage, 100);
    }

    function showPage() {
        try{
            document.getElementById("loading-icons").style.display = "block";
        } catch(err) {}
    }
</script>


    <script src="/js/search.js"></script>







  <section id="search-content" class="py-2">
    <div class="container" id="search-results"></div>
  </section>
</body>

</html>